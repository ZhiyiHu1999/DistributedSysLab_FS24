GPU 0: NVIDIA GeForce RTX 3090 (UUID: GPU-c2927e9a-08b2-a1cd-17a1-092a418bac6e)
GPU 1: NVIDIA GeForce RTX 3090 (UUID: GPU-9d7f82f3-c503-8ee9-26f2-424ddefe47e2)
GPU 2: NVIDIA GeForce RTX 3090 (UUID: GPU-96b59d15-054d-c99f-68bf-406414f8d051)
GPU 0: NVIDIA GeForce RTX 3090 (UUID: GPU-cdb8590d-7b7f-deec-f4f5-8c132c2bbfed)
GPU 1: NVIDIA GeForce RTX 3090 (UUID: GPU-4bab2c5f-3d91-e162-3057-f8068c36d803)
GPU 2: NVIDIA GeForce RTX 3090 (UUID: GPU-f5a5d6fc-28e6-6fda-a6fe-0c13357c69bb)
GPU 0: NVIDIA GeForce RTX 3090 (UUID: GPU-c2927e9a-08b2-a1cd-17a1-092a418bac6e)
GPU 1: NVIDIA GeForce RTX 3090 (UUID: GPU-9d7f82f3-c503-8ee9-26f2-424ddefe47e2)
GPU 2: NVIDIA GeForce RTX 3090 (UUID: GPU-96b59d15-054d-c99f-68bf-406414f8d051)
GPU 0: NVIDIA GeForce RTX 3090 (UUID: GPU-cdb8590d-7b7f-deec-f4f5-8c132c2bbfed)
GPU 1: NVIDIA GeForce RTX 3090 (UUID: GPU-4bab2c5f-3d91-e162-3057-f8068c36d803)
GPU 2: NVIDIA GeForce RTX 3090 (UUID: GPU-f5a5d6fc-28e6-6fda-a6fe-0c13357c69bb)
The local rank is: 0
ault43:577153:577153 [0] NCCL INFO Bootstrap : Using enp225s0f1:148.187.105.53<0>
ault43:577153:577153 [0] NCCL INFO NET/Plugin : Plugin load (libnccl-net.so) returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory
ault43:577153:577153 [0] NCCL INFO NET/Plugin : No plugin found, using internal implementation
ault43:577153:577153 [0] NCCL INFO cudaDriverVersion 12010
NCCL version 2.17.1+cuda11.8
The local rank is: 1
ault44:805399:805399 [1] NCCL INFO cudaDriverVersion 12010
ault44:805399:805399 [1] NCCL INFO Bootstrap : Using enp225s0f1:148.187.105.54<0>
ault44:805399:805399 [1] NCCL INFO NET/Plugin : Plugin load (libnccl-net.so) returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory
ault44:805399:805399 [1] NCCL INFO NET/Plugin : No plugin found, using internal implementation
ault44:805399:805399 [1] NCCL INFO NET/IB : No device found.
ault44:805399:805399 [1] NCCL INFO NET/Socket : Using [0]enp225s0f1:148.187.105.54<0>
ault44:805399:805399 [1] NCCL INFO Using network Socket
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577153:577153 [0] NCCL INFO NET/IB : No device found.
ault43:577153:577153 [0] NCCL INFO NET/Socket : Using [0]enp225s0f1:148.187.105.53<0>
ault43:577153:577153 [0] NCCL INFO Using network Socket
ault43:577153:577153 [0] NCCL INFO NCCL_TOPO_DUMP_FILE set by environment to ./results/Topology_Intra_Node.txt
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577153:577153 [0] NCCL INFO NCCL_GRAPH_DUMP_FILE set by environment to ./results/Graph.txt
ault43:577153:577153 [0] NCCL INFO Channel 00/02 :    0   1   2   3
ault43:577153:577153 [0] NCCL INFO Channel 01/02 :    0   1   2   3
ault43:577153:577153 [0] NCCL INFO Trees [0] 1/2/-1->0->-1 [1] 1/-1/-1->0->2
ault43:577153:577153 [0] NCCL INFO P2P Chunksize set to 131072
ault43:577153:577153 [0] NCCL INFO Channel 00/0 : 3[81000] -> 0[41000] [receive] via NET/Socket/0
ault43:577153:577153 [0] NCCL INFO Channel 01/0 : 3[81000] -> 0[41000] [receive] via NET/Socket/0
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577153:577153 [0] NCCL INFO Channel 00 : 0[41000] -> 1[81000] via SHM/direct/direct
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577153:577153 [0] NCCL INFO Channel 01 : 0[41000] -> 1[81000] via SHM/direct/direct
ault43:577153:577153 [0] NCCL INFO Connected all rings
ault43:577153:577153 [0] NCCL INFO Channel 00/0 : 2[41000] -> 0[41000] [receive] via NET/Socket/0
ault43:577153:577153 [0] NCCL INFO Channel 01/0 : 2[41000] -> 0[41000] [receive] via NET/Socket/0
ault43:577153:577153 [0] NCCL INFO Channel 00/0 : 0[41000] -> 2[41000] [send] via NET/Socket/0
ault43:577153:577153 [0] NCCL INFO Channel 01/0 : 0[41000] -> 2[41000] [send] via NET/Socket/0
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577153:577153 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577153:577153 [0] NCCL INFO Connected all trees
ault43:577153:577153 [0] NCCL INFO NCCL_PROTO set by environment to Simple
ault43:577153:577153 [0] NCCL INFO NCCL_ALGO set by environment to Ring
ault43:577153:577153 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ault43:577153:577153 [0] NCCL INFO 2 coll channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
ault43:577153:577153 [0] NCCL INFO comm 0x56b1370 rank 0 nranks 4 cudaDev 0 busId 41000 commId 0x88cd28246c6fb1b0 - Init COMPLETE
ault43:577153:577153 [0] NCCL INFO comm 0x56b1370 rank 0 nranks 4 cudaDev 0 busId 41000 - Destroy COMPLETE
[MPI Rank 0] Success 
The local rank is: 1
ault43:577155:577155 [1] NCCL INFO cudaDriverVersion 12010
ault43:577155:577155 [1] NCCL INFO Bootstrap : Using enp225s0f1:148.187.105.53<0>
ault43:577155:577155 [1] NCCL INFO NET/Plugin : Plugin load (libnccl-net.so) returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory
ault43:577155:577155 [1] NCCL INFO NET/Plugin : No plugin found, using internal implementation
ault43:577155:577155 [1] NCCL INFO NET/IB : No device found.
ault43:577155:577155 [1] NCCL INFO NET/Socket : Using [0]enp225s0f1:148.187.105.53<0>
ault43:577155:577155 [1] NCCL INFO Using network Socket
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault43:577155:577155 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
ault43:577155:577155 [1] NCCL INFO P2P Chunksize set to 131072
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577155:577155 [1] NCCL INFO Channel 00/0 : 1[81000] -> 2[41000] [send] via NET/Socket/0
ault43:577155:577155 [1] NCCL INFO Channel 01/0 : 1[81000] -> 2[41000] [send] via NET/Socket/0
ault43:577155:577155 [1] NCCL INFO Connected all rings
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577155:577155 [1] NCCL INFO Channel 00 : 1[81000] -> 0[41000] via SHM/direct/direct
ault43:577155:577155 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault43:577155:577155 [1] NCCL INFO Channel 01 : 1[81000] -> 0[41000] via SHM/direct/direct
ault43:577155:577155 [1] NCCL INFO Connected all trees
ault43:577155:577155 [1] NCCL INFO NCCL_PROTO set by environment to Simple
ault43:577155:577155 [1] NCCL INFO NCCL_ALGO set by environment to Ring
ault43:577155:577155 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ault43:577155:577155 [1] NCCL INFO 2 coll channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
ault43:577155:577155 [1] NCCL INFO comm 0x56aff60 rank 1 nranks 4 cudaDev 1 busId 81000 commId 0x88cd28246c6fb1b0 - Init COMPLETE
ault43:577155:577155 [1] NCCL INFO comm 0x56aff60 rank 1 nranks 4 cudaDev 1 busId 81000 - Destroy COMPLETE
[MPI Rank 1] Success 
ault44:805399:805399 [1] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2
ault44:805399:805399 [1] NCCL INFO P2P Chunksize set to 131072
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805399:805399 [1] NCCL INFO Channel 00/0 : 3[81000] -> 0[41000] [send] via NET/Socket/0
ault44:805399:805399 [1] NCCL INFO Channel 01/0 : 3[81000] -> 0[41000] [send] via NET/Socket/0
ault44:805399:805399 [1] NCCL INFO Connected all rings
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805399:805399 [1] NCCL INFO Channel 00 : 3[81000] -> 2[41000] via SHM/direct/direct
ault44:805399:805399 [1] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805399:805399 [1] NCCL INFO Channel 01 : 3[81000] -> 2[41000] via SHM/direct/direct
ault44:805399:805399 [1] NCCL INFO Connected all trees
ault44:805399:805399 [1] NCCL INFO NCCL_PROTO set by environment to Simple
ault44:805399:805399 [1] NCCL INFO NCCL_ALGO set by environment to Ring
ault44:805399:805399 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ault44:805399:805399 [1] NCCL INFO 2 coll channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
ault44:805399:805399 [1] NCCL INFO comm 0x56b2750 rank 3 nranks 4 cudaDev 1 busId 81000 commId 0x88cd28246c6fb1b0 - Init COMPLETE
ault44:805399:805399 [1] NCCL INFO comm 0x56b2750 rank 3 nranks 4 cudaDev 1 busId 81000 - Destroy COMPLETE
[MPI Rank 3] Success 
The local rank is: 0
ault44:805397:805397 [0] NCCL INFO cudaDriverVersion 12010
ault44:805397:805397 [0] NCCL INFO Bootstrap : Using enp225s0f1:148.187.105.54<0>
ault44:805397:805397 [0] NCCL INFO NET/Plugin : Plugin load (libnccl-net.so) returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory
ault44:805397:805397 [0] NCCL INFO NET/Plugin : No plugin found, using internal implementation
ault44:805397:805397 [0] NCCL INFO NET/IB : No device found.
ault44:805397:805397 [0] NCCL INFO NET/Socket : Using [0]enp225s0f1:148.187.105.54<0>
ault44:805397:805397 [0] NCCL INFO Using network Socket
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 1(=81000) and dev 0(=41000)
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault44:805397:805397 [0] NCCL INFO Trees [0] 3/-1/-1->2->0 [1] 3/0/-1->2->-1
ault44:805397:805397 [0] NCCL INFO P2P Chunksize set to 131072
ault44:805397:805397 [0] NCCL INFO Channel 00/0 : 1[81000] -> 2[41000] [receive] via NET/Socket/0
ault44:805397:805397 [0] NCCL INFO Channel 01/0 : 1[81000] -> 2[41000] [receive] via NET/Socket/0
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault44:805397:805397 [0] NCCL INFO Channel 00 : 2[41000] -> 3[81000] via SHM/direct/direct
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault44:805397:805397 [0] NCCL INFO Channel 01 : 2[41000] -> 3[81000] via SHM/direct/direct
ault44:805397:805397 [0] NCCL INFO Connected all rings
ault44:805397:805397 [0] NCCL INFO Channel 00/0 : 0[41000] -> 2[41000] [receive] via NET/Socket/0
ault44:805397:805397 [0] NCCL INFO Channel 01/0 : 0[41000] -> 2[41000] [receive] via NET/Socket/0
ault44:805397:805397 [0] NCCL INFO Channel 00/0 : 2[41000] -> 0[41000] [send] via NET/Socket/0
ault44:805397:805397 [0] NCCL INFO Channel 01/0 : 2[41000] -> 0[41000] [send] via NET/Socket/0
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault44:805397:805397 [0] NCCL INFO Could not enable P2P between dev 0(=41000) and dev 1(=81000)
ault44:805397:805397 [0] NCCL INFO Connected all trees
ault44:805397:805397 [0] NCCL INFO NCCL_PROTO set by environment to Simple
ault44:805397:805397 [0] NCCL INFO NCCL_ALGO set by environment to Ring
ault44:805397:805397 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ault44:805397:805397 [0] NCCL INFO 2 coll channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
ault44:805397:805397 [0] NCCL INFO comm 0x56b1610 rank 2 nranks 4 cudaDev 0 busId 41000 commId 0x88cd28246c6fb1b0 - Init COMPLETE
ault44:805397:805397 [0] NCCL INFO comm 0x56b1610 rank 2 nranks 4 cudaDev 0 busId 41000 - Destroy COMPLETE
[MPI Rank 2] Success 
Collecting data...
Generating '/tmp/nsys-report-fccc.qdstrm'
Collecting data...
Generating '/tmp/nsys-report-733b.qdstrm'
Collecting data...
Generating '/tmp/nsys-report-1a91.qdstrm'
Collecting data...
Generating '/tmp/nsys-report-4d21.qdstrm'
[1/1] [0%                          ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [0%                          ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [11%                         ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [===22%                      ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [=====30%                    ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [===========53%              ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [==============62%           ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [================70%         ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [===================79%      ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [=====================88%    ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [=====================89%    ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [======================90% [1/1] [0%                          ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [0%                          ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [8%                          ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [14%                         ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [==20%                       ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [==========47%               ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [===========52%              ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [============56%             ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [============57%             ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [===============66%          ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [===================82%      ] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [========================10[1/1] [0%                          ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [0%                          ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [11%                         ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [======35%                   ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [=========45%                ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [============56%             ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [==============64%           ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [=================72%        ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [===================80%      ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [=====================89%    ] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [========================100%] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep[1/1] [========================100%] example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep
Generated:
    /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep
[1/1] [0%                          ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [0%                          ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [===22%                      ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [=====31%                    ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [========42%                 ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [===========51%              ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [==============63%           ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [================71%         ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [===================81%      ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [======================90%   ] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [========================100%] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep[1/1] [========================100%] example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep
  ] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [========================100%] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep[1/1] [========================100%] example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep
Generated:
    /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep
Generated:
    /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep
0%] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep[1/1] [========================100%] example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep
Generated:
    /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep
Printing the start_time_map (PID -> Start Timestamp):
PID: 577077, Start Timestamp: 
PID: 577078, Start Timestamp: 
PID: 805322, Start Timestamp: 
PID: 805321, Start Timestamp: 
Warning: No start timestamp found for PID 577077, skipping /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault43.cscs.ch_577077.nsys-rep
Warning: No start timestamp found for PID 577078, skipping /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault43.cscs.ch_577078.nsys-rep
Warning: No start timestamp found for PID 805321, skipping /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault44.cscs.ch_805321.nsys-rep
Warning: No start timestamp found for PID 805322, skipping /users/zhu/DistributedSysLab_FS24/nccl_example/results/nsys_reports/example_2_nsys_report_ault44.cscs.ch_805322.nsys-rep
Nsys_Events has been exported to nsys_events_intermediate_output.json
Merged_Nsys_Events has been exported to nsys_events_merged_output.json
Final goal file has been generated
Graphviz output written to ./results/example_2.dot
